<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Studio Standalone Test</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      body{margin:0;background:#0b1220;color:#fff;font-family:system-ui; padding: 12px;}
      h1 {font-size: 1.5em; margin-bottom: 1rem;}
       [data-shotstack-studio]{background:#000;border-radius:8px;}
      [data-shotstack-timeline]{background:#111827;border-radius:8px;margin-top:16px;}
      [data-shotstack-controls]{margin-bottom:16px;}
    </style>
  </head>
  <body>
    <h1>Studio Standalone Test</h1>

    <div data-shotstack-studio style="height:480px;"></div>
    <div data-shotstack-controls></div>
    <div data-shotstack-timeline style="height:300px;"></div>

    <script type="module">
      import '@pixi/sound'; // ensure audio loader is registered
      import { Edit, Canvas, Controls, Timeline } from 'https://cdn.jsdelivr.net/npm/@shotstack/shotstack-studio/+esm';

      (async () => {
        // 1. Retrieve an edit from a template
        const templateUrl = "https://shotstack-assets.s3.amazonaws.com/templates/hello-world/hello.json";
        const response = await fetch(templateUrl);
        if (!response.ok) throw new Error(`Failed to fetch template: ${response.statusText}`);
        const template = await response.json();

        // 2. Initialize the edit with dimensions and background color
        const edit = new Edit(template.output.size, template.timeline.background);
        await edit.load();

        // 3. Create a canvas to display the edit
        const canvas = new Canvas(template.output.size, edit);
        
        // 4. Add keyboard controls
        const controls = new Controls(edit);

        // 5. Add timeline for visual editing
        const timeline = new Timeline(edit, {
          width: template.output.size.width,
          height: 300
        });

        // 6. Load all components, which will render them to their respective data-attributes
        await Promise.all([
          canvas.load(),
          controls.load(),
          timeline.load(),
        ]);
        
        // 7. Finally, load the template data into the edit
        await edit.loadEdit(template);

      })().catch(e => {
        document.body.insertAdjacentHTML('beforeend',
          `<div style="background:#fce4e4;color:#900;padding:12px;border-radius:6px;margin-top:12px">
             Failed to load studio: ${e?.message || e}
           </div>`);
        console.error(e);
      });
    </script>
  </body>
</html>